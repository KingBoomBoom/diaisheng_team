<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>迪爱生数据平台</title>
    <link rel="stylesheet" href="../resources/layui/css/layui.css" media="all">
    <link href="../resources/layui/css/layui.mobile.css" rel="stylesheet">
    <script src="../resources/layui/layui.all.js" charset="utf-8"></script>
    <link href="../resources/css/lib/bootstrap.min.css" rel="stylesheet">
    <link href="../resources/css/style.css" rel="stylesheet">
    <link href="../resources/css/list.css" rel="stylesheet">
</head>
<body>
<!-- jquery vendor -->
<script src="../resources/js/lib/jquery.min.js"></script>
<script src="../resources/js/lib/jquery.nanoscroller.min.js"></script>
<!-- bootstrap -->
<script src="../resources/js/lib/bootstrap.min.js"></script>

<div class="right_content" style="position: relative;height: 650px; width:300px;border: solid; border-radius:10px;border-color:#cccccc; border-width:1px;margin-left:20px; margin-top: 30px; box-shadow: 5px 5px #e6d9d9;">
    <p class="ex"><b>迪爱生</b></p>
    <p class="ex" style=" color: #cccccc; font-size:10px;">00015203000000000001</p>
</div>
    <div id="l2"  style="position: relative;margin-left: 340px; margin-top:-650px;border: solid; border-radius:10px; border-color:  #ccccff; border-width: 1px; box-shadow: 5px 5px #e6d9d9; ">
    <section id="dataList" style="height: 30px">
        <p style="margin: 0px;margin-left: 10px; padding-top: 10px; "><b style="">设备名称:迪爱生</b></p>
        <table class="layui-table" id="listInfo" lay-filter="demoEvent"></table>
    </section>
</div>
<script type="text/html" id="barDemo">
    <div id="caozuo">
        <button type="button" class="layui-btn" id="history" lay-event="history">历史记录</button>
        <button type="button" class="layui-btn" id="collection" lay-event="collection">主动采集</button>
        <button type="button" class="layui-btn" id="task" lay-event="task">定时任务</button>
    </div>
</script>

<script type="text/javascript">
    function Get(x){
        var pointID = document.getElementById(x).value;
        var time = '';
        var currentData = '';
        $.ajax({
            url:"/diaisheng/valueadmin/getdatabypoint",
            type:"post",
            data:{"x":x},
            dataType:"json",
            success:function(data){
                $.each(data.dataValue,function(key,value){
                    time=value.createTime;
                    currentData=value.value;
                });
                if(pointID == d1){
                    time1.innerHTML=time;
                    value1.innerHTML=currentData;
                }else if(pointID == d2){
                    time2.innerHTML=time;
                    value2.innerHTML=currentData;
                }else if(pointID == d3){
                    time3.innerHTML=time;
                    value3.innerHTML=currentData;
                }else if(pointID == d4){
                    time4.innerHTML=time;
                    value4.innerHTML=currentData;
                }else if(pointID == d5){
                    time5.innerHTML=time;
                    value5.innerHTML=currentData;
                }else if(pointID == d6){
                    time6.innerHTML=time;
                    value6.innerHTML=currentData;
                }else if(pointID == d7){
                    time7.innerHTML=time;
                    value7.innerHTML=currentData;
                }else if(pointID == d8){
                    time8.innerHTML=time;
                    value8.innerHTML=currentData;
                }else if(pointID == d9){
                    time9.innerHTML=time;
                    value9.innerHTML=currentData;
                }else if(pointID == d10){
                    time10.innerHTML=time;
                    value10.innerHTML=currentData;
                }else if(pointID == d11){
                    time11.innerHTML=time;
                    value11.innerHTML=currentData;
                }else if(pointID == d12){
                    time12.innerHTML=time;
                    value12.innerHTML=currentData;
                }else if(pointID == d13){
                    time13.innerHTML=time;
                    value13.innerHTML=currentData;
                }else if(pointID == d14){
                    time14.innerHTML=time;
                    value14.innerHTML=currentData;
                }else if(pointID == d15){
                    time15.innerHTML=time;
                    value15.innerHTML=currentData;
                }else if(pointID == d16){
                    time16.innerHTML=time;
                    value16.innerHTML=currentData;
                }else{
                    time17.innerHTML=time;
                    value17.innerHTML=currentData;
                }


            },
            error: function (errorMsg) {
                //请求失败时执行该函数
                alert("图表请求数据失败!");
                myChart.hideLoading();
            }
        })
    }
    function updateList(){
        layui.use(['table','laypage'], function() {
            var table = layui.table
                , form = layui.form
                ,laypage = layui.laypage;
            table.render({
                elem: '#listInfo'
                , url: "/diaisheng/valueadmin/getdata"
                , cols: [[
                    {type: 'numbers'}
                    , {field: 'dataPoint', title: 'ID', width: 70,sort:true,align: 'center',templet: '<div>{{d.dataPoint.dataPointId}}</div>'}
                    , {field: 'dataPoint', title: '数据点', width: 145,align: 'center',templet: '<div>{{d.dataPoint.dataPointName}}</div>'}
                    , {field: 'dataPoint', title: '从机名称', width: 150,align: 'center',templet: '<div>{{d.dataPoint.dataModel.dataModelName}}</div>'}
                    , {field: 'createTime', title: '更新时间', width: 175,sort:true,align: 'center'}
                    , {field: 'value', title: '当前值', width: 82,sort:true,align: 'center'}
                    , {
                        field: 'modify',
                        title: '操作',
                        width: 270,
                        unresize:true,
                        align: 'center',
                        toolbar: '#barDemo',
                        event: "modifyAdmin",
                        style: "cursor:pointer"
                    }
                ]]
            });
            //监听单元格事件
            table.on('tool(demoEvent)', function(obj){
                var data = obj.data;

                var tr = obj.tr; //获得当前行 tr 的DOM对象
                if(obj.event==="history"){
                    //console.log(data);
                    window.location.href="/diaisheng/data/dataexport?data="
                        +data.dataPoint.dataPointId+"&shebei="+encodeURI(data.dataPoint.dataPointName)
                        +"&congji="+encodeURI(data.dataPoint.dataModel.dataModelName);
                }else if(obj.event==="collection"){

                }else if(obj.event==="task"){

                }
            });
        });
        setTimeout('updateList()',60000);
    }
    $(function(){
       // UpdateData();
        updateList();

    });
</script>

</body>

</html>

